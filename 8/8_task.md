# Задание 8

+ Каждую букву использовать 1 раз => permutation (перестановки)
+ Произвольное количество раз => product (декартово произведение)
+ Обыкновенные комбинации, уникальные => combinations (комбинации)

# Важные моменты:

> 1. ПЕРВАЯ ЦИФРА НЕ МОЖЕТ БЫТЬ НУЛЁМ (нужно прописывать s[0] != '0')
> 2. Буквы записывать в алфавитном порядке!!! (вместо 'СОЙКА' пишем 'АЙКОС')
> 3. permutations не учитывает одинаковые буквы. Чтобы это исправить, нужно использовать set.

# Формулировки

> (4359 kege) Марат составляет шестибуквенные слова из букв слова А, И, К, Л, М, Ь и записывает их в алфавитном порядке
> в список. Найдите номер первого слова в списке, начинающегося на К и заканчивающегося на Ь, в котором каждая буква
> встречается всего лишь раз, а разница между номерами этого слова и его перевёртыша составляет 26655.

```python
from itertools import product

words = list("".join(word) for word in product('АИКЛМЬ', repeat=6))


def valid(s):
    c1 = s[0] == 'К' and s[-1] == 'Ь'
    c2 = all(s.count(c) == 1 for c in 'АИКЛМЬ')
    c3 = words.index(s[::-1]) - words.index(s) == 26655

    return c1 and c2 and c3


cnt = 0
for i in words:
    cnt += 1
    if valid(i):
        print(sum(map(int, str(cnt))))
        break
```

> Никакие две четные или две нечетные цифры не должны стоять рядом (№1926, kompege)

```python
s = ''.join(x)
if s[0] != '0':
    f = True
    for j in range(len(s) - 1):
        prev = int(s[j])
        nxt = int(s[j + 1])
        cond1 = prev % 2 == 0 and nxt % 2 == 0
        cond2 = prev % 2 != 0 and nxt % 2 != 0
        if (cond1 or cond2) == 1:
            f = False
            break
    if f:
        cnt += 1
```

> Определите количество шестизначных чисел, записанных в семеричной системе счисления, в записи которых ровно одна
> цифра 6, при этом чётные и нечётные цифры чередуются.

```python
from itertools import product


def valid(n):
    s = str(n)
    for i in range(0, len(s) - 1):
        x, y = int(s[i]), int(s[i + 1])
        if (x + y) % 2 == 0:
            return False

    return True


cnt = 0
for i in product('0123456', repeat=6):
    s = ''.join(i)
    if s[0] != '0' and s.count('6') == 1 and valid(s):
        cnt += 1

print(cnt)
```

> Петя составляет 7-буквенные слова из букв Т, О, С, Е, Р. Две одинаковые буквы не могут стоять рядом. Буква С может
> стоять только между буквами О и Е или Е и О (ОСЕ, ЕСО — можно, ОСО — нельзя). Сколько слов может составить Петя?

```python
from itertools import product

cnt = 0
for i in product('ТОСЕР', repeat=7):
    s = ''.join(i)
    if all(s.count(j * 2) == 0 for j in 'ТОСЕР'):
        if s[0] != 'С' and s[-1] != 'С':
            f = True
            for j in range(1, len(s) - 1):
                if s[j] == 'С':
                    c1 = s[j - 1] == 'Е' and s[j + 1] == 'О'
                    c2 = s[j - 1] == 'О' and s[j + 1] == 'Е'
                    if c1 or c2:
                        continue
                    else:
                        f = False
                        break
            if f:
                cnt += 1

print(cnt)
```

## Правило произведения

+ Пусть объект a можно выбрать m способами, после чего объект b можно выбрать n способами. Тогда упорядоченную
  пару (a, b) можно выбрать m * n способами

```python
from itertools import product

cnt = 0
# repeat - количество букв в составляемом слове
for x in product('СЛОВО', repeat=4):
    s = ''.join(x)
    # если первая буква согласная и последняя гласная
    if s[0] in 'СЛВ' and s[-1] in 'О':
        cnt += 1

print(cnt)
```

## Размещения

+ Пусть имеется множество, содержащее n элементов. Произвольный упорядоченный набор, составленный из k различных
  элементов данного множества, называется размещением из n элементов по k элементов (или просто размещением из n по k).

### Пример задачи

> Вася составляет 6-буквенные слова, в которых есть только буквы К, А, Н, Т, причём буква К используется в каждом слове
> ровно 2 раза. Каждая из других допустимых букв может встречаться в слове любое количество раз или не встречаться
> совсем.
> Словом считается любая допустимая последовательность букв, необязательно осмысленная. Сколько существует таких слов,
> которые может написать Вася?

### Решение

+ Аналитическое

> Посчитаем количество способов поставить букву К: (6 * 5) / 2! = 15. На остальные 4 позиции мы можем поставить
> оставшиеся
> буквы 3^4 способами. Итоговое количество слов получается: 3^4 * 15 = 1215

+ Программное

```python
from itertools import product

cnt = 0
for x in product('КАНТ', repeat=6):
    s = ''.join(x)
    if s.count('К') == 2:
        cnt += 1
print(cnt)
```

## Подслучаи

### Задача

> Вася составляет 4-буквенные слова, в которых есть только буквы Л, Е, Т, О, причём буква Е используется в каждом слове
> хотя бы 1 раз. Каждая из других допустимых букв может встречаться в слове любое количество раз или не встречаться
> совсем. Словом считается любая допустимая последовательность букв, не обязательно осмысленная. Сколько существует
> таких
> слов, которые может написать Вася?

### Решение

+ Аналитическое (от противного):

> Посчитаем общее количество слов и вычтем количество слов без Е: всего = 256, без Е = 3^4 = 81.
> Итого: 256 - 81 = 175 слов.

+ Программное:

```python
from itertools import product

word = 'ЛЕТО'
cnt = 0
for x in product(word, repeat=4):
    s = ''.join(x)
    if s.count('Е') >= 1:
        cnt += 1

print(cnt)  # cnt = 175
```

### Задача

> Ученица составляет 5-буквенные слова из букв ГЕПАРД. При этом в каждом слове ровно одна буква Г, слово не может
> начинаться на букву А и заканчиваться буквой Е. Какое количество слов может составить ученица?
> Итого: 2200 слов

### Решение

+ Аналитическое

+ Программное

```python
from itertools import product

word = 'ГЕПАРД'
cnt = 0
for x in product(word, repeat=5):
    s = ''.join(x)
    if s.count('Г') == 1 and s[0] != 'А' and s[-1] != 'Е':
        cnt += 1
print(cnt)
```

## Перестановки

+ Пусть имеется множество, содержащее n элементов. Произвольная цепочка
  длины n, составленная из всех элементов данного множества, называется перестановкой этого
  множества (или перестановкой n элементов).
  Иными словами, перестановка n элементов — это размещение из n по n.

+ Формула: $P_n = n!$

+ Формула включений-исключений: комбинаторная формула, позволяющая определить мощность объединения конечного числа
  конечных множеств, которые в общем случае могут пересекаться друг с другом.

### Задача

> Петя составляет 7-буквенные слова перестановкой букв слова АССАСИН. Сколько всего различных слов может составить
> Петя?

### Решение

```python
from itertools import permutations as pm

cnt = 0
for x in set(pm('АССАСИН')):
    cnt += 1
print(cnt)
```

### Задача

> Вася составляет 5-буквенные коды из букв К, А, Л, И, Й. Каждую букву нужно использовать ровно 1 раз, при этом код не
> может начинаться с буквы Й и не может содержать сочетания ИА. Сколько различных кодов может составить Вася?

### Решение

+ Аналитическое (Формула включений-исключений)

> Всего слов - слова, начинающиеся на Й - слова, содержащие ИА + слова, начинающиеся на Й и содержащие ИА =
> 5! - 4! - 4! + 3! = 120 - 24 - 24 + 6 = 78

+ Программное

```python
from itertools import permutations as pm

cnt = 0
for x in pm('КАЛИЙ'):
    s = ''.join(x)
    if s[0] != 'Й' and 'ИА' not in s:
        cnt += 1
print(cnt)
```

### Задача

> Петя составляет 5-буквенные слова из букв К, О, Л, У, Н. Каждую букву нужно использовать ровно 1 раз, при этом код при
> этом нельзя ставить подряд две гласные или две согласные. Сколько различных кодов может составить Петя?

### Решение

```python
from itertools import permutations as pm

cnt = 0
w = ['ОУ', 'УО', 'КЛ', 'ЛК', 'КН', 'НК', 'ЛН', 'НЛ']
for x in pm('КОЛУН'):
    s = ''.join(x)
    if all(sub not in s for sub in w):
        cnt += 1
print(cnt)
```

### Задача

> Маша составляет 7-буквенные коды из букв П, Е, С, К, А, Р, Ь. Каждую букву нужно использовать ровно 1 раз, при этом
> код буква Ь не может стоять на первом месте, а также перед буквами Е, А и Р. Сколько различных кодов может составить
> Маша?

### Решение

```python
from itertools import permutations as pm

cnt = 0
for x in pm('ПЕСКАРЬ'):
    s = ''.join(x)
    if s[0] != 'Ь' and all(sub not in s for sub in ['ЬЕ', 'ЬА', 'ЬР']):
        cnt += 1
print(cnt)
```

# Числа

### Задача

> Мила составляет 4-значные числа в 8-ичной системе. Сколько различных чисел, делящихся на 4 без остатка, может
> составить Мила?

### Решение

```python
from itertools import product

cnt = 0
for x in product('01234567', repeat=4):
    s = ''.join(x)
    if s[0] != '0' and s[-1] in '04':
        cnt += 1
print(cnt)
```

### Задача

> Евгения составляет 4-значные числа в 8-ичной системе счисления.
> Числа должны начинаться с чётной цифры, и цифры в них располагаются в невозрастающем
> порядке. Сколько различных чисел может составить Евгения?

### Решение

```python
from itertools import product

cnt = 0
for x in product('01234567', repeat=4):
    s = ''.join(x)
    if s[0] != '0' and s[0] >= s[1] >= s[2] >= s[3]:
        cnt += 1
print(cnt)
```

### Пример задачи 3

> Сколько слов длины n в q-буквенном алфавите, в которых любые две буквы различны?

### Решение задачи 3

```python
from itertools import product

n = 3
q = 8
cnt = 0
for x in product('01234567', repeat=5):
    s = ''.join(x)
    if all(s[i] != s[i + 1] for i in range(0, len(s) - 1)):
        cnt += 1
print(cnt)
```

## Перебор слов

### Задача

> Все шестибуквенные слова, составленные из букв А, В, О, Р, Т, записаны в алфавитном порядке и пронумерованы начиная с
> Ниже приведено начало списка. 1. АААААА ...
> Под каким номером стоит слово ВОРОТА?

```python
from itertools import product

cnt = 0
for i in product('АВОРТ', repeat=6):
    cnt += 1
    s = ''.join(i)
    if s == 'ВОРОТА':
        print(cnt)
        break
```

### Задача

> Все 5-буквенные слова, составленные из букв А, К, Р, У, записаны в алфавитном порядке. Вот начало списка:

> 1.ААААА
> 2.ААААК
> 3.ААААР
> 4.ААААУ
> 5.АААКА

> Запишите слово, которое стоит на 350-м месте от начала списка.

### Решение

```python
from itertools import product

cnt = 0
# буквы слова нужно записывать в алфавитном порядке!
for x in product('АКРУ', repeat=5):
    cnt += 1
    s = ''.join(x)
    if cnt == 350:
        print(s)
```

### Задача

> Все 5-буквенные слова, составленные из букв А, О, У, записаны в алфавитном порядке. Вот начало списка:
> 1. ААААА
> 2. ААААО
> 3. ААААУ
> 4. АААОА

> Какое количество слов находятся между словами УАУАУ и ОУОУА (включая эти слова)?

### Решение

```python
from itertools import product

cnt, cnt1, cnt2 = 0, 0, 0
for x in product('АОУ', repeat=5):
    cnt += 1
    s = ''.join(x)
    if s == 'УАУАУ':
        cnt2 = cnt
    if s == 'ОУОУА':
        cnt1 = cnt
print(cnt2 - cnt1 + 1)
```

### Задача

> Все четырехбуквенные слова, в составе которых могут быть только буквы П, Я, Т, Ь, Д, Н, Е, Й, записаны в алфавитном
> порядке и пронумерованы начиная с 1. Ниже приведено начало списка. 1. ДДДД 2. ДДДЕ 3. ДДДЙ 4. ДДДН 5. ДДДП 6. ДДДТ 7.
> ДДДЬ 8. ДДДЯ 9. ДДЕД … Под каким номером в списке идёт последнее слово, которое не содержит ни одной гласной и все
> буквы в нем различны?

### Решение

```python
from itertools import product

c = 0
for i, w in enumerate(product(sorted(set('ПЯТЬДНЕЙ')), repeat=4), start=1):
    if all(c not in w for c in 'ЯЕ') and len(set(w)) == 4:
        c = i

print(c)
```


