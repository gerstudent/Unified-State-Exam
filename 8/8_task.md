# Задание 8

+ Каждую букву использовать 1 раз => permutation (перестановки)
+ Произвольное количество раз => product (декартово произведение)
+ Обыкновенные комбинации, уникальные => combinations (комбинации)

> Важные моменты:
> 1. permutations не учитывает одинаковые буквы. Чтобы это исправить, нужно использовать set.

# Формулировки

1. (258) Найдите номер первого слова в списке, начинающегося на К и заканчивающегося на Ь, в котором каждая буква
   встречается
   всего лишь раз, а разница между номерами этого слова и его перевёртыша составляет 26655.

```python
def valid(s):
    return s[0] == 'К' and s[-1] == 'Ь'
    and len(set(s)) == 6 and
    word.index(s[::-1]) - word.index(s) == 26655
```

2. Сколько существует слов, стоящих на позициях с номером большим 1000, в которых нет двух одинаковых подряд идущих
   букв? (257, kpolyakov)

```python
# номер больше 1000
words = words[1000:]

# нет двух одинаковых подряд идущих букв
all(c1 != c2 for c1, c2 in zip(w, w[1:]))
```

3. Никакие две четные или две нечетные цифры не должны стоять рядом (№1926, kompege)

```python
s = ''.join(x)
if s[0] != '0':
    f = True
    for j in range(len(s) - 1):
        prev = int(s[j])
        nxt = int(s[j + 1])
        cond1 = prev % 2 == 0 and nxt % 2 == 0
        cond2 = prev % 2 != 0 and nxt % 2 != 0
        if (cond1 or cond2) == 1:
            f = False
            break
    if f: cnt += 1
```

## Правило произведения

+ Пусть объект $a$ можно выбрать $m$ способами, после чего объект $b$ можно выбрать $n$ способами. Тогда упорядоченную
  пару $(a, b)$ можно выбрать $m * n$ способами

```python
from itertools import product

cnt = 0
# repeat - количество букв в составляемом слове
for x in product('СЛОВО', repeat=4):
    s = ''.join(x)
    # если первая буква согласная и последняя гласная
    if s[0] in 'СЛВ' and s[-1] in 'О':
        cnt += 1

print(cnt)
```

## Размещения

+ Пусть имеется множество, содержащее n элементов. Произвольный упорядоченный набор, составленный из k различных
  элементов данного множества, называется размещением из n элементов по k элементов (или просто размещением из n по k).

### Пример задачи

> Вася составляет 6-буквенные слова, в которых есть только буквы К, А, Н, Т, причём буква К используется в каждом слове
> ровно 2 раза. Каждая из других допустимых букв может встречаться в слове любое количество раз или не встречаться
> совсем.
> Словом считается любая допустимая последовательность букв, необязательно осмысленная. Сколько существует таких слов,
> которые может написать Вася?

### Решение

+ Аналитическое

> Посчитаем количество способов поставить букву К: (6 * 5) / 2! = 15. На остальные 4 позиции мы можем поставить
> оставшиеся
> буквы 3^4 способами. Итоговое количество слов получается: 3^4 * 15 = 1215

+ Программное

```python
from itertools import product

cnt = 0
for x in product('КАНТ', repeat=6):
    s = ''.join(x)
    if s.count('К') == 2:
        cnt += 1
print(cnt)
```

## Подслучаи

### Пример задачи

> Вася составляет 4-буквенные слова, в которых есть только буквы Л, Е, Т, О, причём буква Е используется в каждом слове
> хотя бы 1 раз. Каждая из других допустимых букв может встречаться в слове любое количество раз или не встречаться
> совсем. Словом считается любая допустимая последовательность букв, не обязательно осмысленная. Сколько существует
> таких
> слов, которые может написать Вася?

### Решение

+ Аналитическое (от противного):

> Посчитаем общее количество слов и вычтем количество слов без Е: всего = 256, без Е = 3^4 = 81.
> Итого: 256 - 81 = 175 слов.

+ Программное:

```python
from itertools import product

word = 'ЛЕТО'
cnt = 0
for x in product(word, repeat=4):
    s = ''.join(x)
    if s.count('Е') >= 1:
        cnt += 1

print(cnt)  # cnt = 175
```

### Пример задачи 2

> Ученица составляет 5-буквенные слова из букв ГЕПАРД. При этом в каждом слове ровно одна буква Г, слово не может
> начинаться на букву А и заканчиваться буквой Е. Какое количество слов может составить ученица?
> Итого: 2200 слов

### Решение задачи 2

+ Аналитическое

+ Программное

```python
from itertools import product

word = 'ГЕПАРД'
cnt = 0
for x in product(word, repeat=5):
    s = ''.join(x)
    if s.count('Г') == 1 and s[0] != 'А' and s[-1] != 'Е':
        cnt += 1
print(cnt)
```

## Перестановки

+ Пусть имеется множество, содержащее n элементов. Произвольная цепочка
  длины n, составленная из всех элементов данного множества, называется перестановкой этого
  множества (или перестановкой n элементов).
  Иными словами, перестановка n элементов — это размещение из n по n.

+ Формула: $P_n = n!$

+ Формула включений-исключений: комбинаторная формула, позволяющая определить мощность объединения конечного числа
  конечных множеств, которые в общем случае могут пересекаться друг с другом.

### Пример задачи 1

> Петя составляет 7-буквенные слова перестановкой букв слова АССАСИН. Сколько всего различных слов может составить
> Петя?

### Решение задачи 1

```python
from itertools import permutations as pm

cnt = 0
for x in set(pm('АССАСИН')):
    cnt += 1
print(cnt)
```

### Пример задачи 2

> Вася составляет 5-буквенные коды из букв К, А, Л, И, Й. Каждую букву нужно использовать ровно 1 раз, при этом код не
> может начинаться с буквы Й и не может содержать сочетания ИА. Сколько различных кодов может составить Вася?

### Решение задачи 2

+ Аналитическое (Формула включений-исключений)

> Всего слов - слова, начинающиеся на Й - слова, содержащие ИА + слова, начинающиеся на Й и содержащие ИА =
> 5! - 4! - 4! + 3! = 120 - 24 - 24 + 6 = 78

+ Программное

```python
from itertools import permutations as pm

cnt = 0
for x in pm('КАЛИЙ'):
    s = ''.join(x)
    if s[0] != 'Й' and 'ИА' not in s:
        cnt += 1
print(cnt)
```

### Пример задачи 3

> Петя составляет 5-буквенные слова из букв К, О, Л, У, Н. Каждую букву нужно использовать ровно 1 раз, при этом код при
> этом нельзя ставить подряд две гласные или две согласные. Сколько различных кодов может составить Петя?

### Решение задачи 3

```python
from itertools import permutations as pm

cnt = 0
w = ['ОУ', 'УО', 'КЛ', 'ЛК', 'КН', 'НК', 'ЛН', 'НЛ']
for x in pm('КОЛУН'):
    s = ''.join(x)
    if all(sub not in s for sub in w):
        cnt += 1
print(cnt)
```

### Пример задачи 4

> Маша составляет 7-буквенные коды из букв П, Е, С, К, А, Р, Ь. Каждую букву нужно использовать ровно 1 раз, при этом
> код буква Ь не может стоять на первом месте, а также перед буквами Е, А и Р. Сколько различных кодов может составить
> Маша?

### Решение задачи 4

```python
from itertools import permutations as pm

cnt = 0
for x in pm('ПЕСКАРЬ'):
    s = ''.join(x)
    if s[0] != 'Ь' and all(sub not in s for sub in ['ЬЕ', 'ЬА', 'ЬР']):
        cnt += 1
print(cnt)
```

# Числа

### Пример задачи 1

> Мила составляет 4-значные числа в 8-ичной системе. Сколько различных чисел, делящихся на 4 без остатка, может
> составить Мила?

### Решение задачи 1

```python
from itertools import product

cnt = 0
for x in product('01234567', repeat=4):
    s = ''.join(x)
    if s[0] != '0' and s[-1] in '04':
        cnt += 1
print(cnt)
```

### Пример задачи 2

> Евгения составляет 4-значные числа в 8-ичной системе счисления.
> Числа должны начинаться с чётной цифры, и цифры в них располагаются в невозрастающем
> порядке. Сколько различных чисел может составить Евгения?

### Решение задачи 2

```python
from itertools import product

cnt = 0
for x in product('01234567', repeat=4):
    s = ''.join(x)
    if s[0] != '0' and s[0] >= s[1] >= s[2] >= s[3]:
        cnt += 1
print(cnt)
```

### Пример задачи 3

> Сколько слов длины n в q-буквенном алфавите, в которых любые две буквы различны?

### Решение задачи 3

```python
from itertools import product

n = 3
q = 8
cnt = 0
for x in product('01234567', repeat=5):
    s = ''.join(x)
    if all(s[i] != s[i + 1] for i in range(0, len(s) - 1)):
        cnt += 1
print(cnt)
```

## Перебор слов

### Пример задачи 1

> Все 5-буквенные слова, составленные из букв А, К, Р, У, записаны в алфавитном порядке. Вот начало списка:

> 1.ААААА
> 2.ААААК
> 3.ААААР
> 4.ААААУ
> 5.АААКА

> Запишите слово, которое стоит на 350-м месте от начала списка.

### Решение задачи 1

```python
from itertools import product

cnt = 0
# буквы слова нужно записывать в алфавитном порядке!
for x in product('АКРУ', repeat=5):
    cnt += 1
    s = ''.join(x)
    if cnt == 350:
        print(s)
```

### Пример задачи 2

> Все 5-буквенные слова, составленные из букв А, О, У, записаны в алфавитном порядке. Вот начало списка:
> 1. ААААА
> 2. ААААО
> 3. ААААУ
> 4. АААОА

> Какое количество слов находятся между словами УАУАУ и ОУОУА (включая эти слова)?

### Решение задачи 2

```python
from itertools import product

cnt = 0
cnt1 = 0
cnt2 = 0
for x in product('АОУ', repeat=5):
    cnt += 1
    s = ''.join(x)
    if s == 'УАУАУ':
        cnt2 = cnt
    if s == 'ОУОУА':
        cnt1 = cnt
print(cnt2 - cnt1 + 1)
```

### Пример задачи 3

> Все четырехбуквенные слова, в составе которых могут быть только буквы П, Я, Т, Ь, Д, Н, Е, Й, записаны в алфавитном
> порядке и пронумерованы начиная с 1. Ниже приведено начало списка. 1. ДДДД 2. ДДДЕ 3. ДДДЙ 4. ДДДН 5. ДДДП 6. ДДДТ 7.
> ДДДЬ 8. ДДДЯ 9. ДДЕД … Под каким номером в списке идёт последнее слово, которое не содержит ни одной гласной и все
> буквы в нем различны?

### Решение задачи 3

```python
from itertools import product

c = 0
for i, w in enumerate(product(sorted(set('ПЯТЬДНЕЙ')), repeat=4), start=1):
    if all(c not in w for c in 'ЯЕ') and len(set(w)) == 4:
        c = i

print(c)
```


